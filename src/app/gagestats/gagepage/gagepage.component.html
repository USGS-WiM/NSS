<ng-template #gagePage let-c="close" let-d="dismiss">
	<div>
		<div class="modal-header">
			<div class="title">GagePage</div>  
			<button class="icon-button" (click)="d('closed')"><i class="far fa-times"></i></button>                
		</div>
	</div>

	<div class="modal-body modal-body-fixed">
		<!--Buttons-->
		<div class="xs-f-start pbottom-sm ptop-sm">
			<button *ngIf="loggedInRole && !editGage" type="button" class="button small blue mright-sm" (click)="editGageStats()">
				<i class="far fa-pencil-alt"></i>
				<span>Edit Gage</span>
			</button>
			<button *ngIf="loggedInRole && editGage" type="button" class="button small green mright-sm" (click)="endEditGageStats()">
				<i class="far fa-check"></i>
				<span>Finish Edits</span>
			</button>
		</div>
		<!--Gage Information-->
		<div>
			<div class="table-title">Gage Information</div>
			<div>
				<table style="border:solid 1px gray" class="custom-table"> 
					<thead>
						<tr>
							<th>Name</th>
							<th>Value</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>USGS Station Number</td>
							<td><a href="https://waterdata.usgs.gov/monitoring-location/{{gage.code}}">{{gage.code}}&nbsp;&nbsp;</a><a href="https://nwis.waterdata.usgs.gov/nwis/inventory/?site_no={{gage.code}}">(Legacy NWIS link)</a></td> 
						</tr>
						<tr>
							<td>Station Name</td>
							<td>{{gage.name}}</td>
						</tr>
						<tr>
							<td>Station Type</td>
							<td>{{gage.stationType.name}}</td>
						</tr>
						<tr>
							<td>Latitude</td>
							<td>{{gage.location.coordinates[1]}}</td>
						</tr>
						<tr>
							<td>Longitude</td>
							<td>{{gage.location.coordinates[0]}}</td>
						</tr>
						<tr>
							<td>Is regulated?</td>
							<td>{{gage.isRegulated}}</td> 
						</tr>
						<tr>
							<td>Agency</td>
							<td>{{gage.agency.name}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<!--Physical Characteristics-->
		<div *ngIf="gage.characteristics.length > 0 && !editGage">
			<div class="table-title">Physical Characteristics</div>
			<div>
				<table style="border:solid 1px gray" class="custom-table"> 
					<thead>
						<tr>
							<th>Characteristic</th>
							<th>Value</th>
							<th>Units</th>
							<th>Citation ID</th>
						</tr>
					</thead>
					<tbody >
						<tr *ngFor="let c of gage.characteristics">
							<td>{{c.variableType.name}}</td>
							<td>{{c.value}}</td>
							<td>{{c.unitType.name}}</td>
							<td>{{c.citationID}}</td>
						<tr>
						</tbody>
				</table>
			</div>
		</div>
		<!--Physcial Characteristics Edit Table-->
		<div *ngIf="gage.characteristics.length > 0 && editGage">
			<div class="table-title">Physical Characteristics
				<button *ngIf="loggedInRole" type="button" class="button small blue mright-xs"  (click)="addPhysicalCharacteristic()">Add Physical Characteristic</button>
			</div>
			<div>
				<table style="border:solid 1px gray" class="custom-table"> 
					<thead>
						<tr>
							<th class="width-5"></th>
							<th>Characteristic</th>
							<th>Value</th>
							<th>Units</th>
							<th>Citation ID</th>
						</tr>
					</thead>
					<tbody >
						<tr *ngFor="let c of gage.characteristics, let cIndex = index">
							<td>	
								<div class="table-icon-buttons">
									<button *ngIf="!c.isEditing" title="Edit Parameter" (click)="editRowClicked(c, cIndex)" class="icon-button" aria-hidden="true">
										<i class="far fa-pencil"></i>
									</button>
									<button *ngIf="c.isEditing" title="Save Parameter" (click)="saveChar(c)"  class="icon-button" aria-hidden="true">
										<i class="far fa-floppy-o"></i>
									</button>
									<button *ngIf="c.isEditing" title="Cancel Edit" (click)="cancelEditRowClicked(c)"  class="icon-button" aria-hidden="true">
										<i class="far fa-history"></i>
									</button>
								</div>
							</td>
							<td>{{c.variableType.name}}</td>
							<td>
								<span *ngIf="!c.isEditing">{{c.value}}</span>
								<span *ngIf="c.isEditing"><input [(ngModel)]="c.value" size="3"></span>
							</td>
							<td>
								<span *ngIf="!c.isEditing">{{c.unitType.name}}</span>
								<span *ngIf="c.isEditing">
									<select [compareWith]="compareObjects" name="unitType" [(ngModel)]="c.unitType" style="width: 100px;">
										<option *ngFor="let unit of units" [ngValue]="unit">{{unit.unit}}</option>
									</select>
								</span>
							</td>
							<td>
								<span *ngIf="!c.isEditing">{{c.citationID}}</span>
								<span *ngIf="c.isEditing"><input [(ngModel)]="c.citationID" size="5"></span>
							</td>
						<tr>
						</tbody>
				</table>
			</div>
		</div>
		<!--Streamflow Statistics-->
		<div *ngIf="gage.statistics.length > 0 && !editGage">
			<div class="table-title">Streamflow Statistics</div>
			<div>
				<div>
					<div>
						<table style="border:solid 1px gray" class="custom-table"> 
							<thead>
								<tr>
									<th>Statistic</th>
									<th>Value</th>
									<th>Units</th>
									<th>Citation ID</th>
									<th>Preferred?</th>
									<th>Years of Record</th> 
								</tr>
							</thead>
							<tbody >
								<tr *ngFor="let s of gage.statistics">
									<td>{{s.regressionType.name}}</td>
									<td>{{s.value}}</td>
									<td>{{s.unitType.name}}</td>
									<td>{{s.citationID}}</td>
									<td>{{s.isPreferred}}</td>
									<td>{{s.yearsofRecord}}</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
		<!--Streamflow Statistics Edit Table-->
		<div *ngIf="gage.statistics.length > 0 && editGage">
			<div class="table-title">Streamflow Statistics
				<button *ngIf="loggedInRole" type="button" class="button small blue mright-xs"  (click)="addStreamflowStatistic()">Add Streamflow Statistic</button>
			</div>
			<div>
				<div>
					<div>
						<table style="border:solid 1px gray" class="custom-table"> 
							<thead>
								<tr>
									<th class="width-5"></th>
									<th>Statistic</th>
									<th>Value</th>
									<th>Units</th>
									<th>Citation ID</th>
									<th>Preferred?</th>
									<th>Years of Record</th> 
								</tr>
							</thead>
							<tbody >
								<tr *ngFor="let s of gage.statistics,  let sIndex = index">
									<td>	
										<div class="table-icon-buttons">
											<button *ngIf="!s.isEditing" title="Edit Parameter" (click)="editRowClicked(s, sIndex)" class="icon-button" aria-hidden="true">
												<i class="far fa-pencil"></i>
											</button>
											<button *ngIf="s.isEditing" title="Save Parameter" (click)="saveStat(s, gIndex, stIndex)"  class="icon-button" aria-hidden="true">
												<i class="far fa-floppy-o"></i>
											</button>
											<button *ngIf="s.isEditing" title="Cancel Edit" (click)="cancelEditRowClicked(s)"  class="icon-button" aria-hidden="true">
												<i class="far fa-history"></i>
											</button>
										</div>
									</td>
									<td>{{s.regressionType.name}}</td>
									<td>
										<span *ngIf="!s.isEditing">{{s.value}}</span>
										<span *ngIf="s.isEditing"><input [(ngModel)]="s.value" size="1"></span>
									</td>
									<td>
										<span *ngIf="!s.isEditing">{{s.unitType.name}}</span>
										<span *ngIf="s.isEditing" >
											<select [(ngModel)]="s.unitType" name="unitType" [compareWith]="compareObjects">
                                                <option *ngFor="let unit of units" [ngValue]="unit">{{unit.unit}}</option>
                                            </select>
										</span>
									</td>
									<td>
										<span *ngIf="!s.isEditing">{{s.citationID}}</span>
										<span *ngIf="s.isEditing"><input [(ngModel)]="s.citationID" size="1"></span>
									</td>
									<td>
										<span *ngIf="!s.isEditing">{{s.isPreferred}}</span>
										<span *ngIf="s.isEditing"><input [(ngModel)]="s.isPreferred" size="5"></span>
									</td>
									<td>
										<span *ngIf="!s.isEditing">{{s.yearsofRecord}}</span>
										<span *ngIf="s.isEditing"><input [(ngModel)]="s.yearsofRecord" size="1"></span>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
		<!--Citations-->
		<div *ngIf="gage.citations.length > 0">
			<div class="table-title">Citations</div>
			<div>
				<table style="border:solid 1px gray" class="custom-table">
					<thead>
						<tr>
							<th class="width-5">ID</th>
							<th>Citation</th>
						</tr>
					</thead>
					<tbody >
						<tr *ngFor="let c of gage.citations">
							<td>{{c.id}}</td>
							<td><a href="{{c.url}}">{{c.author}}&nbsp;{{c.title}}</a></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<!-- Footer / Buttons -->
	<div class="modal-body-footer">
		<button type="button" (click)="d('closed')" [disabled]="editGage" class="button black">Close</button>
	</div>
</ng-template>
