<ng-template #manageCitations let-c="close" let-d="dismiss">
	<div>
		<div class="modal-header">
			<div class="title">Manage Citations</div>  
			<button class="icon-button" (click)="d('closed')"><i class="far fa-times"></i></button>                
		</div>

		<div class="modal-body modal-body-fixed">
			<!-- Search Input -->
			<div>
				<input type="text" #input placeholder="Search" (keyup)="filter(input.value)">
			</div>

			<table class="custom-table table-striped table-scroll mtop-sm">
				<thead>
					<tr>
						<th class="width-60">Citation</th>
						<th class="width-35">Associated Regression Regions</th>
						<th class="width-5"></th>
					</tr>
				</thead>
				<tbody>
					<tr *ngFor="let c of filteredData; let cIndex = index">
						<!-- Col 1, Citation -->
						<td class="width-60">
							<div class="half-space">
								<span *ngIf="!c.isEditing">{{ c.author }}</span>
								<span *ngIf="c.isEditing"><textarea class='break' name="author" [(ngModel)]="c.author" required></textarea></span>
							</div>
							<div>
								<span *ngIf="!c.isEditing">{{ c.title }}</span>
								<span *ngIf="c.isEditing"><textarea class='break' name="title" [(ngModel)]="c.title" required></textarea></span>
							</div>
							<div>
								<a *ngIf="!c.isEditing" [href]="c.citationURL" [target]="_blank">
									<span *ngIf="!c.isEditing">{{ c.citationURL }}</span>
								</a>
								<span *ngIf="c.isEditing"><textarea  class='break' name="citationURL" [(ngModel)]="c.citationURL" required></textarea></span>
							</div>
						</td>
						<!-- Col 2, Associated Regression Region -->
						<td class="width-35">
							<span *ngFor="let e of c.regressionRegions">
								<div>{{e.name}}</div>
							</span>
						</td>
						<!-- Col 3 - Buttons -->
						<td class="width-5">
							<!-- Editing -->
							<div [class.hidden]="!showAddCitations" class="cell-buttons">
								<button *ngIf="!c.isEditing" title="Edit Citation"  (click)="editRowClicked(c, cIndex)" class="icon-button" [disabled]="!checkManagerCitations(c)" aria-hidden="true">
									<i class="far fa-pencil"></i>
								</button> 
								<button *ngIf="c.isEditing" title="Save Citation" (click)="saveCitation(c)" class="icon-button" aria-hidden="true">
									<i class="far fa-floppy-o"></i>
								</button>
								<button *ngIf="c.isEditing" title="Cancel Edit" (click)="CancelEditRowClicked()" class="icon-button" aria-hidden="true">
									<i class="far fa-history"></i>
								</button>
								<button *ngIf="!c.isEditing" title="Delete Citation" (click)="deleteCitation(c.id)" class="icon-button" [disabled]="c.regressionRegions?.length>0" aria-hidden="true">
									<i class="far fa-times"></i>
								</button>
							</div>
							<!-- Not editing -->
							<div [class.hidden]="showAddCitations" class="cell-buttons"> 
								<button title="Add Citation" (click)="addExistingCitation(l); d('closed')" class="icon-button" aria-hidden="true">
									<i class="far fa-plus"></i>
								</button>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>

	<!-- Footer / Buttons -->
	<div class="modal-body-footer">
		<button type="button" (click)="d('closed')" class="button black">Close</button>
	</div>
</ng-template>